<Window x:Class="NxDataManager.Views.ProgressWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="å¤‡ä»½è¿›åº¦è¯¦æƒ…" Height="500" Width="700"
        WindowStartupLocation="CenterOwner"
        Background="#F5F5F5">
    
    <Window.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        
        <Style x:Key="InfoText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#666"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>
        
        <Style x:Key="ProgressCard" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- æ ‡é¢˜æ  -->
        <TextBlock Grid.Row="0" Text="{Binding TaskName, StringFormat='ä»»åŠ¡: {0}'}" 
                   FontSize="20" FontWeight="Bold" Foreground="#333" Margin="0,0,0,20"/>
        
        <!-- è¿›åº¦å†…å®¹ -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- æ€»ä½“è¿›åº¦ -->
                <Border Style="{StaticResource ProgressCard}">
                    <StackPanel>
                        <TextBlock Text="ðŸ“Š æ€»ä½“è¿›åº¦" Style="{StaticResource SectionHeader}"/>
                        
                        <ProgressBar Height="30" Value="{Binding OverallPercentage}" 
                                     Maximum="100" Foreground="#4CAF50" 
                                     BorderBrush="#E0E0E0" BorderThickness="1"/>
                        
                        <TextBlock Text="{Binding OverallPercentage, StringFormat='{}{0:F1}%'}" 
                                   FontSize="24" FontWeight="Bold" 
                                   Foreground="#4CAF50" 
                                   HorizontalAlignment="Center" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- æ–‡ä»¶ç»Ÿè®¡ -->
                <Border Style="{StaticResource ProgressCard}">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ æ–‡ä»¶ç»Ÿè®¡" Style="{StaticResource SectionHeader}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="æ€»æ–‡ä»¶æ•°: "/>
                                    <Run Text="{Binding TotalFiles}" FontWeight="Bold"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="å·²å¤„ç†: "/>
                                    <Run Text="{Binding ProcessedFiles}" FontWeight="Bold" Foreground="#4CAF50"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="å‰©ä½™: "/>
                                    <Run Text="{Binding RemainingFiles}" FontWeight="Bold"/>
                                </TextBlock>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1">
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="æ€»å¤§å°: "/>
                                    <Run Text="{Binding TotalSizeFormatted}" FontWeight="Bold"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="å·²ä¼ è¾“: "/>
                                    <Run Text="{Binding ProcessedSizeFormatted}" FontWeight="Bold" Foreground="#4CAF50"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource InfoText}">
                                    <Run Text="å‰©ä½™: "/>
                                    <Run Text="{Binding RemainingSizeFormatted}" FontWeight="Bold"/>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- ä¼ è¾“é€Ÿåº¦ -->
                <Border Style="{StaticResource ProgressCard}">
                    <StackPanel>
                        <TextBlock Text="âš¡ ä¼ è¾“ä¿¡æ¯" Style="{StaticResource SectionHeader}"/>
                        
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="å½“å‰é€Ÿåº¦: "/>
                            <Run Text="{Binding CurrentSpeed}" FontWeight="Bold" Foreground="#2196F3"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="å¹³å‡é€Ÿåº¦: "/>
                            <Run Text="{Binding AverageSpeed}" FontWeight="Bold"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="å·²ç”¨æ—¶é—´: "/>
                            <Run Text="{Binding ElapsedTime}" FontWeight="Bold"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="é¢„è®¡å‰©ä½™: "/>
                            <Run Text="{Binding EstimatedTimeRemaining}" FontWeight="Bold"/>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
                <!-- å½“å‰æ–‡ä»¶ -->
                <Border Style="{StaticResource ProgressCard}">
                    <StackPanel>
                        <TextBlock Text="ðŸ“„ å½“å‰å¤„ç†" Style="{StaticResource SectionHeader}"/>
                        
                        <TextBlock Text="{Binding CurrentFileName}" 
                                   Style="{StaticResource InfoText}"
                                   FontWeight="SemiBold"
                                   TextTrimming="CharacterEllipsis"
                                   ToolTip="{Binding CurrentFileName}"/>
                        
                        <ProgressBar Height="8" Value="{Binding CurrentFilePercentage}" 
                                     Maximum="100" Margin="0,8,0,0"
                                     Foreground="#FF9800"/>
                    </StackPanel>
                </Border>
                
                <!-- æœ€è¿‘æ–‡ä»¶åˆ—è¡¨ -->
                <Border Style="{StaticResource ProgressCard}">
                    <StackPanel>
                        <TextBlock Text="ðŸ“‹ æœ€è¿‘å¤„ç†çš„æ–‡ä»¶" Style="{StaticResource SectionHeader}"/>
                        
                        <ListBox ItemsSource="{Binding RecentFiles}" 
                                 Height="120"
                                 BorderThickness="0"
                                 Background="Transparent">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" 
                                               Style="{StaticResource InfoText}"
                                               TextTrimming="CharacterEllipsis"/>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- åº•éƒ¨æŒ‰é’® -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" 
                    HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="â¸ï¸ æš‚åœ" Width="100" Height="36" Margin="0,0,10,0"
                    Command="{Binding PauseCommand}"
                    IsEnabled="{Binding CanPause}"/>
            <Button Content="â–¶ï¸ æ¢å¤" Width="100" Height="36" Margin="0,0,10,0"
                    Command="{Binding ResumeCommand}"
                    IsEnabled="{Binding CanResume}"/>
            <Button Content="â¹ï¸ åœæ­¢" Width="100" Height="36" Margin="0,0,10,0"
                    Command="{Binding StopCommand}"
                    IsEnabled="{Binding CanStop}"/>
            <Button Content="å…³é—­" Width="100" Height="36"
                    Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
